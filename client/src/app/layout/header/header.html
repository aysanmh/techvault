<header class="header">
  <div class="header-container">
    <a routerLink="/">
      <img src="/images/logo.png" alt="app logo" class="logo" />
    </a>

    <nav class="nav">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }"
        >Home</a
      >
      <a routerLink="/shop" routerLinkActive="active">Shop</a>
      <a routerLink="/test-error" routerLinkActive="active">Errors</a>
    </nav>

    <div class="header-actions">
      <a
        routerLink="/cart"
        routerLinkActive="active"
        [matBadge]="cartService.itemCount()"
        matBadgeSize="large"
        class="custom-badge"
      >
        <mat-icon>shopping_cart</mat-icon>
      </a>

      <div *ngIf="accountService.currentUser(); else loggedOut">
        <button mat-button [matMenuTriggerFor]="menu">
          <mat-icon>arrow_drop_down</mat-icon>
          <span>{{ accountService.currentUser()?.email }}</span>
        </button>
      </div>

      <ng-template #loggedOut>
        <button routerLink="/account/login" mat-stroked-button type="button">Login</button>
        <button routerLink="/account/register" mat-stroked-button type="button">Register</button>
      </ng-template>
    </div>
  </div>

  <mat-progress-bar
    *ngIf="busyService.loading()"
    mode="indeterminate"
    class="progress-bar"
  ></mat-progress-bar>
</header>

<mat-menu #menu="matMenu" class="px-5">
  <button mat-menu-item class="px-3" routerLink="/cart">
    <mat-icon>shopping_cart</mat-icon>
    My cart
  </button>
  <button mat-menu-item class="px-3" routerLink="/orders">
    <mat-icon>history</mat-icon>
    My orders
  </button>
  <mat-divider></mat-divider>
  <button mat-menu-item class="px-3" (click)="logout()">
    <mat-icon>logout</mat-icon>
    Logout
  </button>
</mat-menu>
